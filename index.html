<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary SEO Meta Tags -->
    <title>Free DocuSign Template to Adobe PDF Converter | Client-Side Tool</title>
    <meta name="title" content="Free DocuSign Template to Adobe PDF Converter | Client-Side Tool">
    <meta name="description" content="Convert DocuSign template exports to Adobe fillable PDFs instantly. Free, secure, client-side converter with real signature fields. Transform DocuSign templates to Adobe AcroForm format.">
    <meta name="keywords" content="DocuSign template, DocuSign template converter, DocuSign to Adobe, template export, DocuSign JSON, PDF converter, Adobe AcroForm, fillable PDF, signature fields, client-side, free, secure, privacy, electronic signature, template migration">
    <meta name="author" content="DocuSign Converter Tool">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://kengrinder.github.io/DocuSign-Convert/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://kengrinder.github.io/DocuSign-Convert/">
    <meta property="og:title" content="Free DocuSign Template to Adobe PDF Converter">
    <meta property="og:description" content="Convert DocuSign template exports to Adobe fillable PDFs instantly. Free, secure, client-side converter with real signature fields.">
    <meta property="og:image" content="https://kengrinder.github.io/DocuSign-Convert/og-image.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://kengrinder.github.io/DocuSign-Convert/">
    <meta property="twitter:title" content="Free DocuSign Template to Adobe PDF Converter">
    <meta property="twitter:description" content="Convert DocuSign template exports to Adobe fillable PDFs instantly. Free, secure, client-side converter with real signature fields.">
    <meta property="twitter:image" content="https://kengrinder.github.io/DocuSign-Convert/og-image.png">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="DocuSign Converter">
    <meta name="application-name" content="DocuSign JSON to PDF Converter">
    <meta name="msapplication-TileColor" content="#667eea">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="format-detection" content="telephone=no">
    <meta name="geo.region" content="US">
    <meta name="geo.placename" content="United States">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="global">
    <meta name="rating" content="general">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-96x96.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
    
    <!-- Fallback favicon using SVG data URI -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><circle cx='16' cy='16' r='15' fill='%23667eea'/><rect x='8' y='6' width='12' height='16' rx='1' fill='white'/><line x1='10' y1='9' x2='18' y2='9' stroke='%23667eea' stroke-width='0.8'/><line x1='10' y1='11' x2='16' y2='11' stroke='%23667eea' stroke-width='0.6'/><line x1='10' y1='13' x2='17' y2='13' stroke='%23667eea' stroke-width='0.6'/><path d='M20 14 L24 16 L20 18' stroke='white' stroke-width='1.5' fill='none'/><rect x='22' y='8' width='6' height='8' rx='0.5' fill='%23e74c3c'/><text x='25' y='13' font-family='Arial' font-size='4' font-weight='bold' fill='white' text-anchor='middle'>PDF</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Load signature libraries for real signature field support -->
    <script type="module" id="signature-libs">
        // Import signature libraries for real signature field functionality
        import { PdfDigitalSigner } from "https://esm.sh/sign-pdf-lib@2.0.3?bundle&deps=pdf-lib@1.17.1,node-forge@1.3.1";
        import { pdflibAddPlaceholder } from "https://esm.sh/@signpdf/placeholder-pdf-lib@3.2.6";
        
        // Make signature libraries globally available for the converter
        window.PdfDigitalSigner = PdfDigitalSigner;
        window.pdflibAddPlaceholder = pdflibAddPlaceholder;
        
    </script>
    <style>
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
        }
        .upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 3rem;
            text-align: center;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        .upload-area:hover {
            border-color: #667eea;
            background: #e3f2fd;
        }
        .upload-area.dragover {
            border-color: #667eea;
            background: #e3f2fd;
            transform: scale(1.02);
        }
        .feature-card {
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        .loading {
            display: none;
        }
        .file-info {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
        }
        .alert {
            border-radius: 10px;
        }
    </style>
    
    <!-- Structured Data (JSON-LD) for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "DocuSign Template to Adobe PDF Converter",
        "description": "Free, secure, client-side tool to convert DocuSign template exports to Adobe fillable PDFs with real signature fields. Transform DocuSign templates to Adobe AcroForm format with privacy-first conversion.",
        "url": "https://kengrinder.github.io/DocuSign-Convert/",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Organization",
            "name": "DocuSign Converter Tool"
        },
        "featureList": [
            "Convert DocuSign templates to Adobe PDFs",
            "Transform template exports to AcroForm",
            "Real signature fields",
            "Client-side processing",
            "Privacy-first design",
            "No file uploads",
            "Adobe AcroForm compatibility",
            "Multi-page template support",
            "Smart field type detection",
            "Template coordinate conversion"
        ],
        "screenshot": "https://kengrinder.github.io/DocuSign-Convert/og-image.png",
        "softwareVersion": "1.0",
        "datePublished": "2024-01-01",
        "dateModified": "2024-01-01",
        "inLanguage": "en",
        "isAccessibleForFree": true,
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "softwareRequirements": "Any modern web browser",
        "memoryRequirements": "Minimal",
        "storageRequirements": "No installation required",
        "permissions": "No special permissions required"
    }
    </script>
    
    <!-- FAQ Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Is this DocuSign template converter free to use?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, this DocuSign template to Adobe PDF converter is completely free to use. No registration, no payment required."
                }
            },
            {
                "@type": "Question",
                "name": "Are my files secure when using this converter?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, your files are completely secure. All processing happens in your browser - no files are uploaded to any server."
                }
            },
            {
                "@type": "Question",
                "name": "Does this converter support signature fields?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, the converter creates real Adobe AcroForm signature fields that work with Adobe Fill & Sign and other PDF viewers."
                }
            },
            {
                "@type": "Question",
                "name": "What file formats are supported?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Input: DocuSign template export JSON files. Output: Adobe fillable PDF files with AcroForm fields."
                }
            },
            {
                "@type": "Question",
                "name": "Do I need to install anything?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "No installation required. This is a web-based tool that works in any modern browser."
                }
            }
        ]
    }
    </script>
    
    <!-- Organization Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "DocuSign Converter Tool",
        "url": "https://kengrinder.github.io/DocuSign-Convert/",
        "logo": "https://kengrinder.github.io/DocuSign-Convert/og-image.png",
        "description": "Free, secure DocuSign template to Adobe PDF converter tool",
        "sameAs": [
            "https://github.com/KenGrinder/DocuSign-Convert"
        ]
    }
    </script>
    
    <!-- Breadcrumb Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://kengrinder.github.io/DocuSign-Convert/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "DocuSign Template Converter",
                "item": "https://kengrinder.github.io/DocuSign-Convert/"
            }
        ]
    }
    </script>
</head>
<body>
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="row justify-content-center text-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold mb-4">
                        <i class="bi bi-file-earmark-pdf me-3"></i>
                        DocuSign Template to Adobe PDF Converter
                    </h1>
                    <p class="lead mb-4">
                        Transform your DocuSign template exports into clean, Adobe fillable PDFs with proper AcroForm field types.
                        Automatically converts DocuSign template fields to Adobe PDF fields including digital signatures, date fields, text fields, and checkboxes.
                        <strong>Free, secure, and completely private</strong> - no file uploads required.
                    </p>
                    <div class="alert alert-info d-inline-block">
                        <i class="bi bi-info-circle me-2"></i>
                        <strong>Note:</strong> This is a client-side converter. Your files are processed locally and never uploaded to any server.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Upload Form -->
                <section class="card shadow-lg border-0" aria-labelledby="upload-heading">
                    <div class="card-body p-4">
                        <h2 id="upload-heading" class="card-title text-center mb-4">
                            <i class="bi bi-upload me-2" aria-hidden="true"></i>
                            Upload Your DocuSign Template Export
                        </h2>
                        
                        <!-- Alert Messages -->
                        <div id="alertContainer"></div>
                        

                        <form id="uploadForm">
                            <!-- File Upload Area -->
                            <div class="upload-area" id="uploadArea">
                                <i class="bi bi-cloud-upload fa-3x text-muted mb-3" style="font-size: 3rem;"></i>
                                <h5 class="mb-3">Drag & Drop your DocuSign template export here</h5>
                                <p class="text-muted mb-3">or click to browse</p>
                                <input type="file" id="fileInput" accept=".json" class="d-none" required>
                                <button type="button" class="btn btn-outline-primary" id="chooseFileBtn">
                                    <i class="bi bi-folder2-open me-2"></i>
                                    Choose File
                                </button>
                                <div id="fileInfo" class="file-info" style="display: none;">
                                    <i class="bi bi-file-earmark-code me-2"></i>
                                    <span id="fileName"></span>
                                    <small class="text-muted d-block" id="fileSize"></small>
                                </div>
                            </div>

                            <!-- Conversion Options -->
                            <div class="mt-4">
                                <h5 class="mb-3">
                                    <i class="bi bi-gear me-2"></i>
                                    Conversion Options
                                </h5>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="mask_header_height" class="form-label">
                                            <i class="bi bi-eye-slash me-1"></i>
                                            Header Mask Height (points)
                                        </label>
                                        <input type="number" class="form-control" id="mask_header_height" 
                                               value="24" min="0" step="0.1">
                                        <div class="form-text">Height to mask from top (default: 24 to hide DocuSign envelope information)</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="mask_footer_height" class="form-label">
                                            <i class="bi bi-eye-slash me-1"></i>
                                            Footer Mask Height (points)
                                        </label>
                                        <input type="number" class="form-control" id="mask_footer_height" 
                                               value="0" min="0" step="0.1">
                                        <div class="form-text">Height to mask from bottom (default: 0)</div>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <label for="exclude_doc_ids" class="form-label">
                                            <i class="bi bi-funnel me-1"></i>
                                            Exclude Document IDs
                                        </label>
                                        <input type="text" class="form-control" id="exclude_doc_ids" 
                                               placeholder="e.g., 123456, 789012">
                                        <div class="form-text">Comma-separated list of document IDs to exclude</div>
                                    </div>
                                </div>

                                <!-- Advanced Field Styling Options -->
                                <div class="mt-4">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6 class="mb-0">
                                            <i class="bi bi-palette me-2"></i>
                                            Field Styling Options
                                        </h6>
                                        <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#stylingOptions" aria-expanded="false" aria-controls="stylingOptions">
                                            <i class="bi bi-chevron-down" id="stylingToggleIcon"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="collapse" id="stylingOptions">
                                    <div class="alert alert-info mb-3">
                                        <i class="bi bi-info-circle me-2"></i>
                                        <strong>Note:</strong> Advanced font styling is limited in client-side PDF generation. 
                                        Field dimensions and basic styling will be applied, but fonts may use PDF defaults.
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="field_width" class="form-label">
                                                <i class="bi bi-arrows-expand me-1"></i>
                                                Default Field Width
                                            </label>
                                            <input type="number" class="form-control" id="field_width" 
                                                   value="120" min="50" max="300" step="10">
                                            <div class="form-text">Default width in points (when DocuSign doesn't specify)</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="field_height" class="form-label">
                                                <i class="bi bi-arrows-expand-vertical me-1"></i>
                                                Default Field Height
                                            </label>
                                            <input type="number" class="form-control" id="field_height" 
                                                   value="20" min="10" max="50" step="2">
                                            <div class="form-text">Default height in points (when DocuSign doesn't specify)</div>
                                        </div>
                                    </div>

                                    <div class="row mt-3">
                                        <div class="col-md-12">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="show_field_names">
                                                <label class="form-check-label" for="show_field_names">
                                                    <i class="bi bi-tag me-1"></i>
                                                    Show Field Names
                                                </label>
                                                <div class="form-text">Display field names as placeholders</div>
                                            </div>
                                        </div>
                                    </div>


                                <div class="row mt-3">
                                    <div class="col-md-6">
                       <div class="form-check">
                           <input class="form-check-input" type="checkbox" id="include_system_tabs">
                           <label class="form-check-label" for="include_system_tabs">
                               <i class="bi bi-gear me-1"></i>
                               Include System Tabs
                           </label>
                           <div class="form-text">Include system-generated tabs (uncheck to filter out unwanted fields)</div>
                       </div>
                                    </div>
                                    <div class="col-md-6">
                       <div class="form-check">
                           <input class="form-check-input" type="checkbox" id="show_field_type_controls" checked>
                           <label class="form-check-label" for="show_field_type_controls">
                               <i class="bi bi-toggle-on me-1"></i>
                               Show Field Type Controls
                           </label>
                           <div class="form-text">Show advanced field type translation settings</div>
                       </div>
                                    </div>
                                </div>

                                <div id="field-type-controls-section" class="mt-3" style="display: none;">
                                    <div class="card">
                                        <div class="card-header">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <h6 class="mb-0"><i class="bi bi-translate me-2"></i>Field Type Translation Settings</h6>
                                                <div class="btn-group btn-group-sm" role="group">
                                                    <button type="button" class="btn btn-outline-primary" id="enableAllFields">
                                                        <i class="bi bi-check-all me-1"></i>Enable All
                                                    </button>
                                                    <button type="button" class="btn btn-outline-secondary" id="disableAllFields">
                                                        <i class="bi bi-x-square me-1"></i>Disable All
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <p class="text-muted small mb-3">Enable/disable specific DocuSign field types for translation to PDF. Disabled field types will be skipped during conversion.</p>
                                            <div class="alert alert-info mb-3" id="field-status-alert" style="display: none;">
                                                <i class="bi bi-info-circle me-2"></i>
                                                <span id="field-status-text"></span>
                                            </div>
                                            <div id="field-type-controls" class="row">
                                                <!-- Field type controls will be populated by JavaScript -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
           </div>

                                    </div> <!-- End collapse -->
                                </div>
                            </div>

                            <!-- Submit Button -->
                            <div class="text-center mt-4">
                                <button type="submit" class="btn btn-primary btn-lg" id="convertBtn">
                                    <i class="bi bi-magic me-2"></i>
                                    Convert to PDF
                                </button>
                                <div class="loading mt-3">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Converting...</span>
                                    </div>
                                    <p class="mt-2">Converting your file, please wait...</p>
                                </div>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Features Section -->
                <section class="mt-5" aria-labelledby="features-heading">
                    <h2 id="features-heading" class="text-center mb-5 h3">Why Choose Our DocuSign Template Converter?</h2>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card feature-card h-100">
                                <div class="card-body text-center">
                                    <i class="bi bi-file-earmark-pdf fa-3x text-primary mb-3" style="font-size: 3rem;" aria-hidden="true"></i>
                                    <h3 class="card-title h5">Adobe PDF Output</h3>
                                    <p class="card-text">Transforms DocuSign template exports into professional Adobe fillable PDFs with proper AcroForm fields and real signature capabilities.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card feature-card h-100">
                                <div class="card-body text-center">
                                    <i class="bi bi-shield-lock fa-3x text-success mb-3" style="font-size: 3rem;" aria-hidden="true"></i>
                                    <h3 class="card-title h5">Privacy First</h3>
                                    <p class="card-text">All processing happens in your browser. Your files never leave your device - complete privacy and security.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card feature-card h-100">
                                <div class="card-body text-center">
                                    <i class="bi bi-arrow-repeat fa-3x text-warning mb-3" style="font-size: 3rem;" aria-hidden="true"></i>
                                    <h3 class="card-title h5">Template Migration</h3>
                                    <p class="card-text">Easily migrate your existing DocuSign templates to Adobe AcroForm format, preserving all template fields and structure.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container text-center">
            <p class="mb-2">
                <i class="bi bi-code-slash me-2"></i>
                Built with JavaScript and PDF-lib | 
                <a href="https://github.com/KenGrinder/DocuSign-Convert" class="text-light">
                    <i class="bi bi-github me-1"></i>View on GitHub
                </a>
            </p>
            <p class="mb-0 small text-light">
                <i class="bi bi-shield-exclamation me-1"></i>
                <strong>Legal Disclaimer:</strong> This tool is not affiliated with, endorsed by, or sponsored by DocuSign or Adobe. 
                It processes user-exported JSON data to create standard PDF files. 
                Users are responsible for ensuring they have the right to convert their documents.
            </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/converter.js"></script>
    <script src="js/field-translators.js"></script>
    <script>
        // File upload handling
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const chooseFileBtn = document.getElementById('chooseFileBtn');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const uploadForm = document.getElementById('uploadForm');
        const convertBtn = document.getElementById('convertBtn');
        const loading = document.querySelector('.loading');
        const alertContainer = document.getElementById('alertContainer');

        // Drag and drop functionality
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                showFileInfo(files[0]);
            }
        });

        // Button click handler (prevents event bubbling)
        chooseFileBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent the upload area click from firing
            fileInput.click();
        });

        // Upload area click handler (only when not clicking the button)
        uploadArea.addEventListener('click', (e) => {
            // Only trigger if the click wasn't on the button
            if (e.target !== chooseFileBtn && !chooseFileBtn.contains(e.target)) {
                fileInput.click();
            }
        });

        // File input change
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                showFileInfo(e.target.files[0]);
            }
        });

        // Collapsible styling options toggle
        const stylingToggle = document.querySelector('[data-bs-target="#stylingOptions"]');
        const stylingToggleIcon = document.getElementById('stylingToggleIcon');
        
        stylingToggle.addEventListener('click', () => {
            const isExpanded = stylingToggle.getAttribute('aria-expanded') === 'true';
            stylingToggleIcon.className = isExpanded ? 'bi bi-chevron-down' : 'bi bi-chevron-up';
        });

        function showFileInfo(file) {
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            fileInfo.style.display = 'block';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                <i class="bi bi-${type === 'danger' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
        }

        // Form submission
        uploadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const file = fileInput.files[0];
            if (!file) {
                showAlert('Please select a JSON file', 'danger');
                return;
            }

            convertBtn.style.display = 'none';
            loading.style.display = 'block';
            alertContainer.innerHTML = '';

            try {
                const text = await file.text();
                const jsonData = JSON.parse(text);
                
                const options = {
                    maskHeaderHeight: parseFloat(document.getElementById('mask_header_height').value) || 0,
                    maskFooterHeight: parseFloat(document.getElementById('mask_footer_height').value) || 0,
                    excludeDocIds: document.getElementById('exclude_doc_ids').value
                        .split(',')
                        .map(id => id.trim())
                        .filter(id => id.length > 0),
                    // Field styling options
                    fieldWidth: parseFloat(document.getElementById('field_width').value) || 120,
                    fieldHeight: parseFloat(document.getElementById('field_height').value) || 20,
                    showFieldNames: document.getElementById('show_field_names').checked,
                    includeSystemTabs: document.getElementById('include_system_tabs').checked
                    // Note: Signature and date fields are now always created as proper AcroForm field types
                    // No additional options needed for field type conversion
                };

                const pdfBytes = await convertDocuSignToPDF(jsonData, options);
                
                // Download the PDF
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name.replace('.json', '_converted.pdf');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showAlert('PDF converted successfully! Download started.', 'success');
                
            } catch (error) {
                showAlert(`Conversion failed: ${error.message}`, 'danger');
            } finally {
                convertBtn.style.display = 'inline-block';
                loading.style.display = 'none';
            }
        });

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize field type controls
            initializeFieldTypeControls();
            
            // Set up field type controls toggle
            document.getElementById('show_field_type_controls').addEventListener('change', function() {
                const section = document.getElementById('field-type-controls-section');
                section.style.display = this.checked ? 'block' : 'none';
            });
            
            // Show the controls by default if checked
            if (document.getElementById('show_field_type_controls').checked) {
                document.getElementById('field-type-controls-section').style.display = 'block';
            }
        });

        /**
         * Initialize field type controls based on available translators
         */
        function initializeFieldTypeControls() {
            const container = document.getElementById('field-type-controls');
            container.innerHTML = '';
            
            // Get field type configurations from the field-translators.js module
            // Use the actual field types if available, otherwise fall back to hardcoded list
            let fieldTypes = {};
            if (typeof getAllFieldTypeConfigs === 'function') {
                const configs = getAllFieldTypeConfigs();
                fieldTypes = Object.fromEntries(
                    Object.entries(configs).map(([key, config]) => [key, { 
                        name: config.name, 
                        description: config.description,
                        enabled: config.enabled 
                    }])
                );
            } else {
                // Fallback configuration if functions aren't loaded yet
                fieldTypes = {
                    'textTabs': { name: 'Text Fields', description: 'Single-line text input fields', enabled: true },
                    'signHereTabs': { name: 'Signature Fields', description: 'Adobe Fill & Sign signature fields', enabled: true },
                    'initialHereTabs': { name: 'Initial Fields', description: 'Adobe Fill & Sign fields for initials', enabled: true },
                    'checkboxTabs': { name: 'Checkbox Fields', description: 'Checkbox form controls', enabled: true },
                    'radioGroupTabs': { name: 'Radio Button Groups', description: 'Radio button groups', enabled: true },
                    'listTabs': { name: 'Dropdown Lists', description: 'Dropdown/combo box selections', enabled: true },
                    'fullNameTabs': { name: 'Full Name Fields', description: 'Auto-populated full name fields', enabled: true },
                    'dateSignedTabs': { name: 'Date Signed Fields', description: 'Auto-populated date fields', enabled: true },
                    'companyTabs': { name: 'Company Fields', description: 'Auto-populated company fields', enabled: true },
                    'titleTabs': { name: 'Title Fields', description: 'Auto-populated job title fields', enabled: true },
                    'emailAddressTabs': { name: 'Email Address Fields', description: 'Auto-populated email fields', enabled: true },
                    'numericalTabs': { name: 'Numerical Fields', description: 'Numeric input fields with validation', enabled: true },
                    'signerAttachmentTabs': { name: 'File Attachment Fields', description: 'File attachment fields for document uploads', enabled: true }
                };
            }
            
            Object.entries(fieldTypes).forEach(([fieldType, config]) => {
                const col = document.createElement('div');
                col.className = 'col-md-6 col-lg-4 mb-3';
                
                col.innerHTML = `
                    <div class="form-check">
                        <input class="form-check-input field-type-toggle" type="checkbox" id="${fieldType}" 
                               ${config.enabled ? 'checked' : ''} data-field-type="${fieldType}">
                        <label class="form-check-label" for="${fieldType}">
                            <strong>${config.name}</strong>
                            <br><small class="text-muted">${config.description}</small>
                        </label>
                    </div>
                `;
                
                container.appendChild(col);
            });
            
            // Add event listeners for field type toggles
            document.querySelectorAll('.field-type-toggle').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const fieldType = this.dataset.fieldType;
                    const enabled = this.checked;
                    
                    // Update the field translator system
                    if (typeof setFieldTypeEnabled === 'function') {
                        setFieldTypeEnabled(fieldType, enabled);
                        updateFieldStatusDisplay();
                    }
                    
                });
            });
            
            // Add event listeners for bulk enable/disable buttons
            document.getElementById('enableAllFields').addEventListener('click', function() {
                document.querySelectorAll('.field-type-toggle').forEach(checkbox => {
                    checkbox.checked = true;
                    if (typeof setFieldTypeEnabled === 'function') {
                        setFieldTypeEnabled(checkbox.dataset.fieldType, true);
                    }
                });
                updateFieldStatusDisplay();
            });
            
            document.getElementById('disableAllFields').addEventListener('click', function() {
                document.querySelectorAll('.field-type-toggle').forEach(checkbox => {
                    checkbox.checked = false;
                    if (typeof setFieldTypeEnabled === 'function') {
                        setFieldTypeEnabled(checkbox.dataset.fieldType, false);
                    }
                });
                updateFieldStatusDisplay();
            });
            
            // Initialize status display
            updateFieldStatusDisplay();
        }
        
        /**
         * Update the field status display to show how many fields are enabled/disabled
         */
        function updateFieldStatusDisplay() {
            const statusAlert = document.getElementById('field-status-alert');
            const statusText = document.getElementById('field-status-text');
            
            if (!statusAlert || !statusText) return;
            
            const checkboxes = document.querySelectorAll('.field-type-toggle');
            const enabledCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const totalCount = checkboxes.length;
            const disabledCount = totalCount - enabledCount;
            
            if (disabledCount === 0) {
                statusText.textContent = `All ${totalCount} field types are enabled. All DocuSign fields will be converted to PDF.`;
                statusAlert.className = 'alert alert-success mb-3';
            } else if (enabledCount === 0) {
                statusText.textContent = `All ${totalCount} field types are disabled. No DocuSign fields will be converted to PDF.`;
                statusAlert.className = 'alert alert-warning mb-3';
            } else {
                statusText.textContent = `${enabledCount} field types enabled, ${disabledCount} disabled. Only enabled field types will be converted to PDF.`;
                statusAlert.className = 'alert alert-info mb-3';
            }
            
            statusAlert.style.display = 'block';
        }
    </script>
</body>
</html>
